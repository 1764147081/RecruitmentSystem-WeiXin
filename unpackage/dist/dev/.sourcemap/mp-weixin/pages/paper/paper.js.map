{"version":3,"file":"paper.js","sources":["pages/paper/paper.vue","E:/000Work/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcGFwZXIvcGFwZXIudnVl"],"sourcesContent":["<template>\n  <view class=\"paper-container\">\n    <view class=\"header\">\n      <text class=\"title\">已填问卷</text>\n    </view>\n\n    <view class=\"questionnaires-list\">\n      <view v-if=\"questionnaires.length === 0\" class=\"empty-tip\">\n        <text>暂无已填问卷</text>\n      </view>\n      <view v-for=\"item in questionnaires\" :key=\"item.id\" class=\"questionnaire-item\">\n        <view class=\"item-header\">\n          <text class=\"item-title\">{{ item.title }}</text>\n         \n        </view>\n <button class=\"delete-btn\" @click=\"deleteQuestionnaire(item.id)\">取消报名</button>\n\n      </view>\n    </view>\n\n    <!-- 底部导航 -->\n    <view class=\"tab-bar\">\n      <view class=\"tab-item\" @click=\"navigateToDepartment\">部门展览</view>\n      <view class=\"tab-item active\" @click=\"navigateToPaper\">已填报</view>\n      <view class=\"tab-item\" @click=\"navigateToInfo\">个人中心</view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport { ref, onMounted } from 'vue';\nimport { request } from '../../common/request';\n\nexport default {\n  setup() {\n    const finish = ref([]);\n    const questionnaires = ref([]);\n\n\tasync function getFinish(){\n\t\tconst res = await request({\n\t\t\turl:`/answer/view/user`,\n\t\t\theader: {\n\t\t\t\t'content-type': 'application/json',\n\t\t\t\t'Authorization': `Bearer ${uni.getStorageSync('authToken')}`\n\t\t\t},\n\t\t})\n\t\tfinish.value=[...res.data]\n\t\tawait getQuestionnaire()\n\t}\n\t\n\tasync function getQuestionName(questionnaireId){\n\t\tconst res = await request({\n\t\t\turl:`/questionnaire/view?questionnaireId=${questionnaireId}`,\n\t\t\theader: {\n\t\t\t\t'content-type': 'application/json',\n\t\t\t\t'Authorization': `Bearer ${uni.getStorageSync('authToken')}`\n\t\t\t},\n\t\t})\n\t\treturn res.data;\n\t} \n\t\n\tasync function getQuestionnaire(){\n\t\t// 使用 Promise.all 等待所有异步操作完成\n\t\tconst promises = finish.value.map(async(val) => {\n\t\t\tlet a = await getQuestionName(val.questionnaireId);\n\t\t\treturn {...a, ...val};\n\t\t});\n\t\t\n\t\t// 等待所有Promise完成\n\t\tquestionnaires.value = await Promise.all(promises);\n\t\tconsole.log('合并后的问卷', questionnaires.value);\n\t}\n\n\n    onMounted(async() => {\n\t\tawait getFinish()\n      console.log('加载已填问卷列表',finish.value);\n    });\n\n    // 跳转到部门列表\n    const navigateToDepartment = () => {\n      uni.reLaunch({\n        url: '/pages/department/department'\n      });\n    };\n\n    // 跳转到已填报页面\n    const navigateToPaper = () => {\n      // 当前页面，不需要跳转\n    };\n\n    // 跳转到个人中心\n    const navigateToInfo = () => {\n      uni.reLaunch({\n        url: '/pages/info/info'\n      });\n    };\n\n    // 删除问卷功能\n    const deleteQuestionnaire = (id) => {\n      // 过滤掉要删除的问卷\n      questionnaires.value = questionnaires.value.filter(item => item.id !== id);\n      \n      // 这里可以添加调用API删除问卷的逻辑\n      // 例如:\n      request({\n        url: `/answer/delete?finishId=${id}`,\n        method: 'POST',\n        header: {\n        \t'content-type': 'application/json',\n        \t'Authorization': `Bearer ${uni.getStorageSync('authToken')}`\n        },\n      }).then(res => {\n        if (res.code === 200) {\n          uni.showToast({ title: '删除成功' });\n        }\n      }).catch(err => {\n        uni.showToast({ title: '删除失败', icon: 'none' });\n      });\n    };\n\n    return {\n      questionnaires,\n      // departmentName,\n      // submitForm,\n      navigateToDepartment,\n      navigateToPaper,\n      navigateToInfo,\n      deleteQuestionnaire\n    };\n  }\n};\n</script>\n\n<style lang=\"scss\">\n.paper-container {\n  padding: 20rpx;\n  padding-bottom: 100rpx;\n  background-color: #f5f5f5;\n  min-height: 100vh;\n}\n\n.header {\n  height: 88rpx;\n  line-height: 88rpx;\n  text-align: center;\n  background-color: #fff;\n  border-bottom: 1rpx solid #eee;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  z-index: 999;\n}\n\n.title {\n  font-size: 36rpx;\n  font-weight: bold;\n  color: #333;\n}\n\n.form-container {\n  margin-top: 120rpx;\n  padding: 20rpx;\n  background-color: #fff;\n  border-radius: 16rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\n}\n\n.form-item {\n  margin-bottom: 30rpx;\n}\n\n.label {\n  display: block;\n  font-size: 28rpx;\n  color: #333;\n  margin-bottom: 10rpx;\n}\n\n.input {\n  width: 100%;\n  height: 80rpx;\n  border: 1rpx solid #eee;\n  border-radius: 8rpx;\n  padding: 0 20rpx;\n  font-size: 28rpx;\n  box-sizing: border-box;\n}\n\n.textarea {\n  width: 100%;\n  height: 200rpx;\n  border: 1rpx solid #eee;\n  border-radius: 8rpx;\n  padding: 20rpx;\n  font-size: 28rpx;\n  box-sizing: border-box;\n}\n\n.value {\n  font-size: 28rpx;\n  color: #666;\n}\n\n.questionnaires-list {\n  margin-top: 120rpx;\n  padding: 20rpx;\n}\n\n.empty-tip {\n  text-align: center;\n  padding: 60rpx 0;\n  color: #999;\n  font-size: 28rpx;\n}\n\n.questionnaire-item {\n  background-color: #fff;\n  border-radius: 16rpx;\n  padding: 24rpx;\n  margin-bottom: 20rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\n}\n\n.item-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 16rpx;\n}\n\n.item-title {\n  font-size: 30rpx;\n  font-weight: bold;\n  color: #333;\n}\n\n.item-time {\n  font-size: 24rpx;\n  color: #999;\n  margin-bottom: 16rpx;\n}\n\n.delete-btn {\n  background-color: #e63946;\n  color: white;\n  border: none;\n  padding: 10rpx 0;\n  width: 75px;\n  border-radius: 8rpx;\n  font-size: 24rpx;\n  cursor: pointer;\n  margin-right: 0; /* 使按钮居右 */\n}\n\n.item-status {\n  display: flex;\n  justify-content: flex-end;\n}\n\n.status-text {\n  font-size: 24rpx;\n  color: #007aff;\n  padding: 4rpx 16rpx;\n  border: 1rpx solid #007aff;\n  border-radius: 16rpx;\n}\n\n.tab-bar {\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  height: 100rpx;\n  background-color: #fff;\n  border-top: 1rpx solid #eee;\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n\n.tab-item {\n  font-size: 28rpx;\n  color: #999;\n  text-align: center;\n  padding: 10rpx 0;\n}\n\n.tab-item.active {\n  color: #e63946;\n  font-weight: bold;\n}\n</style>\n","import MiniProgramPage from 'C:/Users/1764147081/Desktop/new/RecruitmentSystem-WeiXin/RecruitmentSystem-WeiXin/pages/paper/paper.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","request","uni","onMounted"],"mappings":";;;AAiCA,MAAK,YAAU;AAAA,EACb,QAAQ;AACN,UAAM,SAASA,kBAAI,CAAA,CAAE;AACrB,UAAM,iBAAiBA,kBAAI,CAAA,CAAE;AAEhC,mBAAe,YAAW;AACzB,YAAM,MAAM,MAAMC,uBAAQ;AAAA,QACzB,KAAI;AAAA,QACJ,QAAQ;AAAA,UACP,gBAAgB;AAAA,UAChB,iBAAiB,UAAUC,cAAAA,MAAI,eAAe,WAAW,CAAC;AAAA,QAC1D;AAAA,OACD;AACD,aAAO,QAAM,CAAC,GAAG,IAAI,IAAI;AACzB,YAAM,iBAAiB;AAAA,IACxB;AAEA,mBAAe,gBAAgB,iBAAgB;AAC9C,YAAM,MAAM,MAAMD,uBAAQ;AAAA,QACzB,KAAI,uCAAuC,eAAe;AAAA,QAC1D,QAAQ;AAAA,UACP,gBAAgB;AAAA,UAChB,iBAAiB,UAAUC,cAAAA,MAAI,eAAe,WAAW,CAAC;AAAA,QAC1D;AAAA,OACD;AACD,aAAO,IAAI;AAAA,IACZ;AAEA,mBAAe,mBAAkB;AAEhC,YAAM,WAAW,OAAO,MAAM,IAAI,OAAM,QAAQ;AAC/C,YAAI,IAAI,MAAM,gBAAgB,IAAI,eAAe;AACjD,eAAO,EAAC,GAAG,GAAG,GAAG,IAAG;AAAA,MACrB,CAAC;AAGD,qBAAe,QAAQ,MAAM,QAAQ,IAAI,QAAQ;AACjDA,oBAAA,MAAA,MAAA,OAAA,+BAAY,UAAU,eAAe,KAAK;AAAA,IAC3C;AAGGC,kBAAAA,UAAU,YAAW;AACvB,YAAM,UAAU;AACZD,oBAAA,MAAA,MAAA,OAAA,+BAAY,YAAW,OAAO,KAAK;AAAA,IACrC,CAAC;AAGD,UAAM,uBAAuB,MAAM;AACjCA,oBAAAA,MAAI,SAAS;AAAA,QACX,KAAK;AAAA,MACP,CAAC;AAAA;AAIH,UAAM,kBAAkB,MAAM;AAAA;AAK9B,UAAM,iBAAiB,MAAM;AAC3BA,oBAAAA,MAAI,SAAS;AAAA,QACX,KAAK;AAAA,MACP,CAAC;AAAA;AAIH,UAAM,sBAAsB,CAAC,OAAO;AAElC,qBAAe,QAAQ,eAAe,MAAM,OAAO,UAAQ,KAAK,OAAO,EAAE;AAIzED,6BAAQ;AAAA,QACN,KAAK,2BAA2B,EAAE;AAAA,QAClC,QAAQ;AAAA,QACR,QAAQ;AAAA,UACP,gBAAgB;AAAA,UAChB,iBAAiB,UAAUC,cAAAA,MAAI,eAAe,WAAW,CAAC;AAAA,QAC1D;AAAA,OACF,EAAE,KAAK,SAAO;AACb,YAAI,IAAI,SAAS,KAAK;AACpBA,wBAAAA,MAAI,UAAU,EAAE,OAAO,OAAQ,CAAA;AAAA,QACjC;AAAA,MACF,CAAC,EAAE,MAAM,SAAO;AACdA,sBAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,OAAK,CAAG;AAAA,MAC/C,CAAC;AAAA;AAGH,WAAO;AAAA,MACL;AAAA;AAAA;AAAA,MAGA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA;EAEJ;AACF;;;;;;;;;;;;;;;;;;;AClIA,GAAG,WAAW,eAAe;"}
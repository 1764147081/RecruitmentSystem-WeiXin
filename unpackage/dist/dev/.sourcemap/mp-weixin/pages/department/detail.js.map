{"version":3,"file":"detail.js","sources":["pages/department/detail.vue","E:/000Work/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZGVwYXJ0bWVudC9kZXRhaWwudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"detail-container\">\r\n\t\t<view class=\"header\">\r\n\t\t\t<text class=\"title\">{{info && info.name ? info.name : '部门详情'}}</text>\r\n\t\t</view>\r\n\r\n\t\t<!-- 海报区域 -->\r\n\t\t<view class=\"poster-container\">\r\n\t\t\t<image :src=\"info && info.image \" mode=\"aspectFill\"></image>\r\n\t\t</view>\r\n\r\n\t\t<!-- 部门介绍 -->\r\n\t\t<view class=\"intro-container\">\r\n\t\t\t<view class=\"section-title\">部门介绍</view>\r\n\t\t\t<view class=\"section-content\">{{ info && info.description ? info.description : '暂无部门介绍' }}</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 部门职责 -->\r\n\t\t<view class=\"duty-container\">\r\n\t\t\t<view class=\"section-title\">部门职责</view>\r\n\t\t\t<view class=\"section-content\">{{ info && info.duties ? info.duties : '暂无部门职责信息' }}</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 问卷填报按钮 -->\r\n\t\t<view class=\"btn-container\">\r\n\t\t\t<button class=\"submit-btn\" @click=\"navigateToQuestionnaire\">点击报名</button>\r\n\t\t</view>\r\n\r\n\t\t<!-- 底部导航 -->\r\n\t\t<view class=\"tab-bar\">\r\n\t\t\t<view class=\"tab-item active\" @click=\"navigateToDepartment\">部门展览</view>\r\n\t\t\t<view class=\"tab-item\" @click=\"navigateToPaper\">已填报</view>\r\n\t\t\t<view class=\"tab-item\" @click=\"navigateToInfo\">个人中心</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tref,\r\n\t\tonMounted\r\n\t} from 'vue';\r\n\timport {\r\n\t\tuseDepartStore\r\n\t} from '@/stores/department.js';\r\n\timport {\r\n\t\trequest\r\n\t} from '../../common/request';\r\n\r\n\r\n\texport default {\r\n\t\tsetup() {\r\n\t\t\tconst token = wx.getStorageSync('authToken');\r\n\t\t\tconst departStore = useDepartStore();\r\n\t\t\tconst loading = ref(false);\r\n\t\t\tconst errorMsg = ref('');\r\n\t\t\tconst departmentInfo = ref({});\r\n\t\t\tlet info = ref({\r\n\t\t\t\tid:'',\r\n\t\t\t\tstationId: '',\r\n\t\t\t\tname: '',\r\n\t\t\t\timage: '',\r\n\t\t\t\tdescription: ''\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// 跳转到问卷页\r\n\t\t\tasync function getQuestionnaire() {\r\n\t\t\t\tlet res = await request({\r\n\t\t\t\t\turl: `/department/view/questionnaire?departmentId=${info.value.id}`,\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t'content-type': 'application/x-www-form-urlencoded',\r\n\t\t\t\t\t\t'Authorization': `Bearer ${token}`\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\treturn res;\r\n\t\t\t}\r\n\t\t\tasync function getFinish(questionnaireId) {\r\n\t\t\t\tconst res = await request({\r\n\t\t\t\t\turl: `/answer/view/user_questionnaire?questionnaireId=${questionnaireId}`,\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t'content-type': 'application/x-www-form-urlencoded',\r\n\t\t\t\t\t\t'Authorization': `Bearer ${token}`\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\treturn res;\r\n\t\t\t}\r\n\t\t\tconst navigateToQuestionnaire = async () => {\r\n\t\t\t\tlet res = await getQuestionnaire()\r\n\t\t\t\tlet ress = await getFinish(res.data.id)\r\n\t\t\t\tif (ress.code === 404) {\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\t// 设置问卷ID\r\n\t\t\t\t\t\tinfo.value.questionnaireId = res.data.id;\r\n\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t\turl: `/pages/department/questionnaire?id=${info.value.questionnaireId}`\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '该部门暂无问卷',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(ress.code === 200){\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '您已填写该问卷',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tonMounted(async () => {\r\n\t\t\t\tconst departmentDetail = departStore.getDepartmentDetail();\r\n\t\t\t\tif (departmentDetail && Object.keys(departmentDetail).length > 0) {\r\n\t\t\t\t\tdepartmentInfo.value = departmentDetail;\r\n\t\t\t\t\tinfo.value = departmentDetail;\r\n\t\t\t\t\tconsole.log('从store获取部门详情数据成功:', departmentInfo.value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.error('从store获取部门详情数据失败');\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '无法从store加载部门详情',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t// 跳转到部门列表\r\n\t\t\tconst navigateToDepartment = () => {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/pages/department/department'\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\t// 跳转到已填报页面\r\n\t\t\tconst navigateToPaper = () => {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/pages/paper/paper'\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\t// 跳转到个人中心\r\n\t\t\tconst navigateToInfo = () => {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/pages/info/info'\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\treturn {\r\n\t\t\t\tdepartmentInfo,\r\n\t\t\t\tnavigateToQuestionnaire,\r\n\t\t\t\tloading,\r\n\t\t\t\tnavigateToDepartment,\r\n\t\t\t\tnavigateToPaper,\r\n\t\t\t\tnavigateToInfo,\r\n\t\t\t\tinfo\r\n\t\t\t};\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t.detail-container {\r\n\t\tpadding-bottom: 100rpx;\r\n\t\tbackground-color: #f5f5f5;\r\n\t\tmin-height: 100vh;\r\n\t}\r\n\r\n\t.header {\r\n\t\theight: 88rpx;\r\n\t\tline-height: 88rpx;\r\n\t\ttext-align: center;\r\n\t\tbackground-color: #fff;\r\n\t\tborder-bottom: 1rpx solid #eee;\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tz-index: 999;\r\n\t}\r\n\r\n\t.title {\r\n\t\tfont-size: 36rpx;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.poster-container {\r\n\t\tmargin-top: 88rpx;\r\n\t\twidth: 100%;\r\n\t\theight: 400rpx;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.poster-container image {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n\r\n\t.intro-container,\r\n\t.duty-container {\r\n\t\tmargin: 20rpx;\r\n\t\tpadding: 20rpx;\r\n\t\tbackground-color: #fff;\r\n\t\tborder-radius: 16rpx;\r\n\t\tbox-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\r\n\t}\r\n\r\n\t.section-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #333;\r\n\t\tmargin-bottom: 20rpx;\r\n\t\tpadding-bottom: 10rpx;\r\n\t\tborder-bottom: 1rpx solid #eee;\r\n\t}\r\n\r\n\t.section-content {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #666;\r\n\t\tline-height: 1.6;\r\n\t\twhite-space: pre-wrap;\r\n\t}\r\n\r\n\t.btn-container {\r\n\t\tmargin: 40rpx 20rpx;\r\n\t}\r\n\r\n\t.submit-btn {\r\n\t\tbackground-color: #e63946;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 32rpx;\r\n\t\tborder-radius: 60rpx;\r\n\t\theight: 88rpx;\r\n\t\tline-height: 88rpx;\r\n\t}\r\n\r\n\t.tab-bar {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-around;\r\n\t\talign-items: center;\r\n\t\theight: 100rpx;\r\n\t\tbackground-color: #fff;\r\n\t\tborder-top: 1rpx solid #eee;\r\n\t\tposition: fixed;\r\n\t\tbottom: 0;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t}\r\n\r\n\t.tab-item {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\r\n\t.tab-item {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #999;\r\n\t\ttext-align: center;\r\n\t\tpadding: 10rpx 0;\r\n\t}\r\n\r\n\t.tab-item.active {\r\n\t\tcolor: #e63946;\r\n\t\tfont-weight: bold;\r\n\t}\r\n</style>","import MiniProgramPage from 'C:/Users/1764147081/Desktop/new/RecruitmentSystem-WeiXin/RecruitmentSystem-WeiXin/pages/department/detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["wx","useDepartStore","ref","request","uni","onMounted"],"mappings":";;;;AAkDC,MAAK,YAAU;AAAA,EACd,QAAQ;AACP,UAAM,QAAQA,cAAAA,KAAG,eAAe,WAAW;AAC3C,UAAM,cAAcC,kBAAAA;AACpB,UAAM,UAAUC,kBAAI,KAAK;AACRA,kBAAAA,IAAI,EAAE;AACvB,UAAM,iBAAiBA,kBAAI,CAAA,CAAE;AAC7B,QAAI,OAAOA,cAAAA,IAAI;AAAA,MACd,IAAG;AAAA,MACH,WAAW;AAAA,MACX,MAAM;AAAA,MACN,OAAO;AAAA,MACP,aAAa;AAAA,IACd,CAAC;AAGD,mBAAe,mBAAmB;AACjC,UAAI,MAAM,MAAMC,uBAAQ;AAAA,QACvB,KAAK,+CAA+C,KAAK,MAAM,EAAE;AAAA,QACjE,QAAQ;AAAA,UACP,gBAAgB;AAAA,UAChB,iBAAiB,UAAU,KAAK;AAAA,QACjC;AAAA,OACA;AACD,aAAO;AAAA,IACR;AACA,mBAAe,UAAU,iBAAiB;AACzC,YAAM,MAAM,MAAMA,uBAAQ;AAAA,QACzB,KAAK,mDAAmD,eAAe;AAAA,QACvE,QAAQ;AAAA,UACP,gBAAgB;AAAA,UAChB,iBAAiB,UAAU,KAAK;AAAA,QACjC;AAAA,OACA;AACD,aAAO;AAAA,IACR;AACA,UAAM,0BAA0B,YAAY;AAC3C,UAAI,MAAM,MAAM,iBAAiB;AACjC,UAAI,OAAO,MAAM,UAAU,IAAI,KAAK,EAAE;AACtC,UAAI,KAAK,SAAS,KAAK;AACtB,YAAI,IAAI,SAAS,KAAK;AAErB,eAAK,MAAM,kBAAkB,IAAI,KAAK;AACtCC,wBAAAA,MAAI,WAAW;AAAA,YACd,KAAK,sCAAsC,KAAK,MAAM,eAAe;AAAA,UACtE,CAAC;AAAA,eACK;AACNA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO;AAAA,YACP,MAAM;AAAA,UACP,CAAC;AAAA,QACF;AAAA,MACD;AACA,UAAG,KAAK,SAAS,KAAI;AACpBA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACP,CAAC;AAAA,MACF;AAAA;AAGDC,kBAAAA,UAAU,YAAY;AACrB,YAAM,mBAAmB,YAAY;AACrC,UAAI,oBAAoB,OAAO,KAAK,gBAAgB,EAAE,SAAS,GAAG;AACjE,uBAAe,QAAQ;AACvB,aAAK,QAAQ;AACbD,+EAAY,qBAAqB,eAAe,KAAK;AAAA,aAC/C;AACNA,sBAAAA,MAAA,MAAA,SAAA,sCAAc,kBAAkB;AAChCA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACP,CAAC;AAAA,MACF;AAAA,IACD,CAAC;AAED,UAAM,uBAAuB,MAAM;AAClCA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,MACN,CAAC;AAAA;AAIF,UAAM,kBAAkB,MAAM;AAC7BA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,MACN,CAAC;AAAA;AAIF,UAAM,iBAAiB,MAAM;AAC5BA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,MACN,CAAC;AAAA;AAGF,WAAO;AAAA,MACN;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA;EAEF;;;;;;;;;;;;;;;;AC1JF,GAAG,WAAW,eAAe;"}
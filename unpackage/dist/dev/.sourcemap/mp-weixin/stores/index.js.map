{"version":3,"file":"index.js","sources":["stores/index.js"],"sourcesContent":["import { defineStore } from 'pinia';\r\nimport { ref } from 'vue';\r\n\r\nexport const useFirstStore = defineStore('first', () => {\r\n\tconst token = ref(\"\");\r\n\tconst user = ref({\r\n\t\tusername: \"\",\r\n\t\tstudentNumber: \"\",\r\n\t\tpassword: \"\",\r\n\t});\r\n\tconst isLoggedIn = ref(false);\r\n\r\n\tfunction logout() {\r\n\t\ttoken.value = '';\r\n\t\tuser.value = { username: '', studentNumber: '', password: '' };\r\n\t\tisLoggedIn.value = false;\r\n\t\twx.removeStorageSync('token');\r\n\t\t\twx.removeStorageSync('authToken');\r\n\t};\r\n\r\n\tfunction setLoginData(res) {\r\n\t\ttoken.value = res.token;\r\n\t\tuser.value.username = res.userInfo?.username || '';\r\n\t\tuser.value.studentNumber = res.userInfo?.studentNumber || '';\r\n\t\tisLoggedIn.value = true;\r\n\t\t// 持久化到本地存储\r\n\t\twx.setStorageSync('token', res.token);\r\n\t};\r\n\r\n\tfunction setToken(newToken) {\r\n\t\ttoken.value = newToken;\r\n\t\tisLoggedIn.value = !!newToken;\r\n\t\t// 持久化到本地存储\r\n\t\twx.setStorageSync('token', newToken);\r\n\t};\r\n\treturn {\r\n\t\tuser,\r\n\t\ttoken,\r\n\t\tisLoggedIn,\r\n\t\tsetLoginData,\r\n\t\tsetToken,\r\n\t\tlogout\r\n\t};\r\n\r\n})\r\n"],"names":["defineStore","ref","wx"],"mappings":";;AAGY,MAAC,gBAAgBA,cAAAA,YAAY,SAAS,MAAM;AACvD,QAAM,QAAQC,kBAAI,EAAE;AACpB,QAAM,OAAOA,cAAAA,IAAI;AAAA,IAChB,UAAU;AAAA,IACV,eAAe;AAAA,IACf,UAAU;AAAA,EACZ,CAAE;AACD,QAAM,aAAaA,kBAAI,KAAK;AAE5B,WAAS,SAAS;AACjB,UAAM,QAAQ;AACd,SAAK,QAAQ,EAAE,UAAU,IAAI,eAAe,IAAI,UAAU;AAC1D,eAAW,QAAQ;AACnBC,uBAAG,kBAAkB,OAAO;AAC3BA,uBAAG,kBAAkB,WAAW;AAAA,EAEnC;AACC,WAAS,aAAa,KAAK;;AAC1B,UAAM,QAAQ,IAAI;AAClB,SAAK,MAAM,aAAW,SAAI,aAAJ,mBAAc,aAAY;AAChD,SAAK,MAAM,kBAAgB,SAAI,aAAJ,mBAAc,kBAAiB;AAC1D,eAAW,QAAQ;AAEnBA,kBAAAA,KAAG,eAAe,SAAS,IAAI,KAAK;AAAA,EAEtC;AACC,WAAS,SAAS,UAAU;AAC3B,UAAM,QAAQ;AACd,eAAW,QAAQ,CAAC,CAAC;AAErBA,kBAAAA,KAAG,eAAe,SAAS,QAAQ;AAAA,EACrC;AACC,SAAO;AAAA,IACN;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF;AAEA,CAAC;;"}
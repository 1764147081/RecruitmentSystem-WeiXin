{"version":3,"file":"app.js","sources":["App.vue","main.js"],"sourcesContent":["<script>\r\n\timport {\r\n\t\tcreateApp\r\n\t} from 'vue';\r\n\timport {\r\n\t\tcreatePinia\r\n\t} from 'pinia';\r\n\timport {\r\n\t\tuseFirstStore\r\n\t} from './stores/index.js';\r\n\timport {\r\n\t\trequest\r\n\t} from './common/request.js';\r\n\r\n\t// 创建Pinia实例\r\n\tconst pinia = createPinia();\r\n\tconst app = createApp({});\r\n\tapp.use(pinia);\r\n\r\n\texport default {\r\n\t\tonLaunch: function() {\r\n\t\t\tconsole.log('App Launch');\r\n\t\t\tthis.initLogin();\r\n\t\t},\r\n\t\tonShow: function() {\r\n\t\t\tconsole.log('App Show');\r\n\t\t},\r\n\t\tonHide: function() {\r\n\t\t\tconsole.log('App Hide');\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tinitLogin() {\r\n\t\t\t\tconst store = useFirstStore();\r\n\r\n\t\t\t\t// 检查本地存储中是否有token\r\n\t\t\t\tconst token = wx.getStorageSync('authToken') || '';\r\n\t\t\t\tconsole.log('当前token:', token);\r\n\r\n\t\t\t\tif (token) {\r\n\t\t\t\t\tconsole.log('发现保存的token，尝试自动登录');\r\n\t\t\t\t\t(async () => {\r\n\r\n\t\t\t\t\t\tlet response = await request({\r\n\t\t\t\t\t\t\turl: \"/user/info\",\r\n\t\t\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\t\t\theader: {\r\n\t\t\t\t\t\t\t\t'content-type': 'application/x-www-form-urlencoded',\r\n\t\t\t\t\t\t\t\t'Authorization': `Bearer ${token}`\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tconsole.log('验证token响应码:', response.code);\r\n\t\t\t\t\t\tif (response.code === 200) {\r\n\t\t\t\t\t\t\t// token有效，保存用户信息到store\r\n\t\t\t\t\t\t\tconsole.log('token验证成功，保存用户信息');\r\n\t\t\t\t\t\t\tstore.setLoginData({\r\n\t\t\t\t\t\t\t\ttoken: token,\r\n\t\t\t\t\t\t\t\tuserInfo: response.data || {}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t// 跳转到首页\r\n\t\t\t\t\t\t\tuni.redirectTo({\r\n\t\t\t\t\t\t\t\turl: '/pages/department/department'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// token无效，清除登录状态\r\n\t\t\t\t\t\t\tconsole.log('token无效，清除登录状态');\r\n\t\t\t\t\t\t\tstore.logout();\r\n\t\t\t\t\t\t\t// 跳转到登录页\r\n\t\t\t\t\t\t\tuni.redirectTo({\r\n\t\t\t\t\t\t\t\turl: '/pages/login/login'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t/*每个页面公共css */\r\n\t@import \"@/uni_modules/uview-plus/index.scss\";\r\n</style>","import App from './App'\r\n\n\n// #ifndef VUE3\nimport Vue from 'vue'\nimport './uni.promisify.adaptor'\nVue.config.productionTip = false\nApp.mpType = 'app'\nconst app = new Vue({\n  ...App\n})\napp.$mount()\n// #endif\nimport uviewPlus from '@/uni_modules/uview-plus'\r\n\n// #ifdef VUE3\nimport { createSSRApp } from 'vue'\r\nimport { createPinia } from 'pinia'\nexport function createApp() {\n  const app = createSSRApp(App);\r\n  const pinia = createPinia();\r\n  app.use(pinia)\r\n  app.use(uviewPlus)\n  return {\n    app,\r\n\tpinia,\n  };\n}\n// #endif"],"names":["createPinia","createApp","uni","useFirstStore","wx","request","app","createSSRApp","App","pinia","uviewPlus"],"mappings":";;;;;;;;;;;;;;;;AAeC,MAAM,QAAQA,cAAAA;AACd,MAAM,MAAMC,wBAAU,CAAA,CAAE;AACxB,IAAI,IAAI,KAAK;AAEb,MAAK,YAAU;AAAA,EACd,UAAU,WAAW;AACpBC,kBAAAA,MAAA,MAAA,OAAA,iBAAY,YAAY;AACxB,SAAK,UAAS;AAAA,EACd;AAAA,EACD,QAAQ,WAAW;AAClBA,kBAAAA,MAAY,MAAA,OAAA,iBAAA,UAAU;AAAA,EACtB;AAAA,EACD,QAAQ,WAAW;AAClBA,kBAAAA,MAAY,MAAA,OAAA,iBAAA,UAAU;AAAA,EACtB;AAAA,EACD,SAAS;AAAA,IACR,YAAY;AACX,YAAM,QAAQC,aAAAA;AAGd,YAAM,QAAQC,cAAE,KAAC,eAAe,WAAW,KAAK;AAChDF,oBAAA,MAAA,MAAA,OAAA,iBAAY,YAAY,KAAK;AAE7B,UAAI,OAAO;AACVA,sBAAAA,MAAA,MAAA,OAAA,iBAAY,mBAAmB;AAC/B,SAAC,YAAY;AAEZ,cAAI,WAAW,MAAMG,uBAAQ;AAAA,YAC5B,KAAK;AAAA,YACL,QAAQ;AAAA,YACR,QAAQ;AAAA,cACP,gBAAgB;AAAA,cAChB,iBAAiB,UAAU,KAAK;AAAA,YAChC;AAAA,UACF,CAAC;AACDH,4DAAY,eAAe,SAAS,IAAI;AACxC,cAAI,SAAS,SAAS,KAAK;AAE1BA,0BAAAA,MAAA,MAAA,OAAA,iBAAY,kBAAkB;AAC9B,kBAAM,aAAa;AAAA,cAClB;AAAA,cACA,UAAU,SAAS,QAAQ,CAAC;AAAA,YAC7B,CAAC;AAEDA,0BAAAA,MAAI,WAAW;AAAA,cACd,KAAK;AAAA,YACN,CAAC;AAAA,iBACK;AAENA,0BAAAA,MAAY,MAAA,OAAA,iBAAA,gBAAgB;AAC5B,kBAAM,OAAM;AAEZA,0BAAAA,MAAI,WAAW;AAAA,cACd,KAAK;AAAA,YACN,CAAC;AAAA,UACF;AAAA;MAEF;AAAA,IACD;AAAA,EACD;AACD;ACzDM,SAAS,YAAY;AAC1B,QAAMI,OAAMC,2BAAaC,SAAG;AAC5B,QAAMC,SAAQT,cAAAA;AACd,EAAAM,KAAI,IAAIG,MAAK;AACb,EAAAH,KAAI,IAAII,qCAAS;AACjB,SAAO;AAAA,IACL,KAAAJ;AAAA,IACH,OAAAG;AAAA,EACD;AACA;;;"}
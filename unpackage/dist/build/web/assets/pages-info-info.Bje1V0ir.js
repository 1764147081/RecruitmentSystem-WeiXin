import{_ as a,u as e,G as l,V as t,v as s,D as o,p as n,W as i,e as c,w as u,i as d,d as f,f as r,k as g,t as m,y as _,C as p}from"./index-BIrkV5je.js";const v=e();const h=a({data:()=>({username:"",college:"",major:"",name:"",email:"",qq:"",avatar:"",profile:""}),methods:{toEditInfo(){l({url:"/pages/info/edit"})},logout(){t({title:"提示",content:"确定要退出登录吗？",success:a=>{a.confirm&&(v.logout(),s({url:"/pages/login/login"}))}})},navigateTocollegement(){l({url:"/pages/collegement/collegement"})},navigateToPaper(){l({url:"/pages/paper/paper"})},navigateToInfo(){},async getUserInfo(){const a=o("authToken");if(!a&&v.token.value&&(console.log("从store获取token"),a=v.token.value),!a)return console.log("未找到token，跳转到登录页面"),void s({url:"/pages/login/login"});let e;console.log("现在获取个人信息"),console.log("token:",a),e=await n({url:"/user/info",method:"GET",header:{"content-type":"application/x-www-form-urlencoded",Authorization:`Bearer ${a}`}}),e&&e.data?(this.username=e.data.username||"",this.college=e.data.college||"",this.name=e.data.name||"",this.email=e.data.email||"",this.qq=e.data.qq||"",this.major=e.data.major||"",this.avatar=e.data.avatar||"/static/assets/nav_icon_avatar_nor.png",this.profile=e.data.profile||"这个人很懒，什么都没有写"):e&&401===e.code&&(i("authToken"),v.logout(),s({url:"/pages/login/login"}))}},onLoad(){this.getUserInfo()},mounted(){this.$nextTick((()=>{const a=document.querySelector(".uni-page-head-hd");a&&(a.style.display="none")}))}},[["render",function(a,e,l,t,s,o){const n=_,i=d,v=p;return f(),c(i,{class:"info-container"},{default:u((()=>[r(i,{class:"user-header"},{default:u((()=>[r(i,{class:"avatar-container"},{default:u((()=>[r(n,{class:"avatar",src:s.avatar,mode:"aspectFill"},null,8,["src"])])),_:1}),r(i,{class:"user-info"},{default:u((()=>[r(v,{class:"user-name"},{default:u((()=>[g(m(s.name),1)])),_:1}),r(v,{class:"user-desc"},{default:u((()=>[g(m(s.profile),1)])),_:1})])),_:1})])),_:1}),r(i,{class:"edit-btn",onClick:o.toEditInfo},{default:u((()=>[r(v,null,{default:u((()=>[g("修改")])),_:1})])),_:1},8,["onClick"]),r(i,{class:"info-list"},{default:u((()=>[r(i,{class:"info-item"},{default:u((()=>[r(v,{class:"info-label"},{default:u((()=>[g("学院")])),_:1}),r(v,{class:"info-value"},{default:u((()=>[g(m(s.college),1)])),_:1})])),_:1}),r(i,{class:"info-item"},{default:u((()=>[r(v,{class:"info-label"},{default:u((()=>[g("专业")])),_:1}),r(v,{class:"info-value"},{default:u((()=>[g(m(s.major),1)])),_:1})])),_:1}),r(i,{class:"info-item"},{default:u((()=>[r(v,{class:"info-label"},{default:u((()=>[g("邮箱")])),_:1}),r(v,{class:"info-value"},{default:u((()=>[g(m(s.email),1)])),_:1})])),_:1}),r(i,{class:"info-item"},{default:u((()=>[r(v,{class:"info-label"},{default:u((()=>[g("学号")])),_:1}),r(v,{class:"info-value"},{default:u((()=>[g(m(s.username),1)])),_:1})])),_:1}),r(i,{class:"info-item"},{default:u((()=>[r(v,{class:"info-label"},{default:u((()=>[g("QQ")])),_:1}),r(v,{class:"info-value"},{default:u((()=>[g(m(s.qq),1)])),_:1})])),_:1})])),_:1}),r(i,{class:"logout-btn",onClick:o.logout},{default:u((()=>[r(v,null,{default:u((()=>[g("退出登录")])),_:1})])),_:1},8,["onClick"]),r(i,{class:"tab-bar"},{default:u((()=>[r(i,{class:"tab-item",onClick:o.navigateTocollegement},{default:u((()=>[g("部门展览")])),_:1},8,["onClick"]),r(i,{class:"tab-item",onClick:o.navigateToPaper},{default:u((()=>[g("已填报")])),_:1},8,["onClick"]),r(i,{class:"tab-item active",onClick:o.navigateToInfo},{default:u((()=>[g("个人中心")])),_:1},8,["onClick"])])),_:1})])),_:1})}],["__scopeId","data-v-457d3a26"]]);export{h as default};
